#these are added comments

import numpy as np
import pandas as pd
import scipy.stats as stats
import matplotlib.pyplot as plt
import sklearn
from sklearn.linear_model import LinearRegression

# import csv
rsa_df = pd.read_csv('/home/harryj/Documents/RSA/Data/JHBMKTSALES.csv')

# convert values/kg to float and restrict to first 2 decimal places
rsa_df['value/kg'] = np.round(rsa_df['value/kg'].astype(float), decimals=2)

# add new collumn with week number approach
rsa_df['week'] = rsa_df['yyyyww'].astype(str)
rsa_df['week'] = ((rsa_df['week'].str[4:6]).astype(int) - 10) + ((rsa_df['week'].str[0:4]).astype(int) - 2008)*52

# create column by commodity type
rsa_df = rsa_df.pivot_table('kg', 'yyyyww', 'jwavg_commodity', aggfunc=np.sum)

#train model
lm = LinearRegression()
lm.fit(rsa_df.drop('APPLES', axis = 1), rsa_df.APPLES)

# plot prediction against actual
plt.scatter(lm.predict(rsa_df.drop('APPLES', axis = 1)), rsa_df.APPLES)
plt.show()
